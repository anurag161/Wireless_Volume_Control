<html>
<head>
<title>TestComServer.idl</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #808080;}
.s1 { color: #a9b7c6;}
.s2 { color: #6a8759;}
.s3 { color: #cc7832;}
.s4 { color: #6897bb;}
</style>
</head>
<body bgcolor="#2b2b2b">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
TestComServer.idl</font>
</center></td></tr></table>
<pre><span class="s0">/* 
b30428b4-cc67-48ba-81db-4c6a6b3db1a3 
*/</span>

<span class="s0">/* 
 
  REMEMBER TO COMPILE A NEW .TLB FILE WHEN THIS CHANGES, 
  AND ALSO TO REMOVE THE comtypes\gen DIRECTORY TO DELETE 
  THE TYPELIB WRAPPERS! 
  The TestServer.py should also be registered again. 
 
*/</span>

<span class="s1">import </span><span class="s2">&quot;oaidl.idl&quot;</span><span class="s1">;</span>
<span class="s1">import </span><span class="s2">&quot;ocidl.idl&quot;</span><span class="s1">;</span>

<span class="s1">[</span>
	<span class="s1">object,</span>
	<span class="s1">oleautomation,</span>
	<span class="s1">uuid(f0a241e2-25d1-4f6d-9461-c67bf262779f),</span>
	<span class="s1">helpstring(</span><span class="s2">&quot;A custom event interface&quot;</span><span class="s1">)</span>
	<span class="s1">]</span>
<span class="s3">interface </span><span class="s1">ITestComServerEvents : IUnknown {</span>
	<span class="s1">[id(</span><span class="s4">10</span><span class="s1">)]</span>
	<span class="s1">HRESULT EvalStarted([</span><span class="s3">in</span><span class="s1">] BSTR what);</span>

	<span class="s1">[id(</span><span class="s4">11</span><span class="s1">)]</span>
	<span class="s1">HRESULT EvalCompleted([</span><span class="s3">in</span><span class="s1">] BSTR what, [</span><span class="s3">in</span><span class="s1">] VARIANT result);</span>
<span class="s1">};</span>

<span class="s1">[</span>
	<span class="s1">object,</span>
	<span class="s0">/* 
      the oleautomation flag enables universal marshalling on non-dispatch 
      interfaces. See Don Box, Page 220. 
    */</span>
	<span class="s1">oleautomation,</span>
	<span class="s1">uuid(</span><span class="s4">58955</span><span class="s1">c76-60a9-4eeb-8b8a-8f92e90d0fe7),</span>
	<span class="s1">helpstring(</span><span class="s2">&quot;ITestComServer interface&quot;</span><span class="s1">)</span>
	<span class="s1">]</span>
<span class="s3">interface </span><span class="s1">ITestComServer : IDispatch {</span>
	<span class="s1">[propget, id(</span><span class="s4">10</span><span class="s1">), helpstring(</span><span class="s2">&quot;returns the id of the server&quot;</span><span class="s1">)]</span>
	<span class="s1">HRESULT id([</span><span class="s3">out</span><span class="s1">, retval] UINT *pid);</span>

	<span class="s1">[propget, id(</span><span class="s4">11</span><span class="s1">), helpstring(</span><span class="s2">&quot;the name of the server&quot;</span><span class="s1">)]</span>
	<span class="s1">HRESULT name([</span><span class="s3">out</span><span class="s1">, retval] BSTR *pname);</span>

	<span class="s1">[propput, id(</span><span class="s4">11</span><span class="s1">), helpstring(</span><span class="s2">&quot;the name of the server&quot;</span><span class="s1">)]</span>
	<span class="s1">HRESULT name([</span><span class="s3">in</span><span class="s1">] BSTR name);</span>

	<span class="s1">[id(</span><span class="s4">12</span><span class="s1">), helpstring(</span><span class="s2">&quot;a method that receives an BSTR [in] parameter&quot;</span><span class="s1">)]</span>
	<span class="s1">HRESULT SetName([</span><span class="s3">in</span><span class="s1">] BSTR name);</span>

	<span class="s1">[id(</span><span class="s4">13</span><span class="s1">), helpstring(</span><span class="s2">&quot;evaluate an expression and return the result&quot;</span><span class="s1">)]</span>
	<span class="s1">HRESULT eval([</span><span class="s3">in</span><span class="s1">] BSTR what, [</span><span class="s3">out</span><span class="s1">, retval] VARIANT *presult);</span>

	<span class="s0">/* Some methods that use defaultvalues */</span>
	<span class="s1">[id(</span><span class="s4">14</span><span class="s1">)]</span>
	<span class="s1">HRESULT do_cy([</span><span class="s3">in</span><span class="s1">, defaultvalue(</span><span class="s4">32.78</span><span class="s1">)] CURRENCY *value);</span>

	<span class="s1">[id(</span><span class="s4">15</span><span class="s1">)]</span>
	<span class="s1">HRESULT do_date([</span><span class="s3">in</span><span class="s1">, defaultvalue(</span><span class="s4">32</span><span class="s1">)] DATE *value);</span>

	<span class="s1">[id(</span><span class="s4">16</span><span class="s1">), helpstring(</span><span class="s2">&quot;execute a statement&quot;</span><span class="s1">)]</span>
	<span class="s1">HRESULT Exec([</span><span class="s3">in</span><span class="s1">] BSTR what);</span>

	<span class="s1">[id(</span><span class="s4">17</span><span class="s1">), helpstring(</span><span class="s2">&quot;execute a statement&quot;</span><span class="s1">)]</span>
	<span class="s1">HRESULT Exec2([</span><span class="s3">in</span><span class="s1">] BSTR what);</span>

	<span class="s1">[id(</span><span class="s4">18</span><span class="s1">), helpstring(</span><span class="s2">&quot;a method with [in] and [out] args in mixed order&quot;</span><span class="s1">)]</span>
	<span class="s1">HRESULT MixedInOut([</span><span class="s3">in</span><span class="s1">] int a, [</span><span class="s3">out</span><span class="s1">] int *b, [</span><span class="s3">in</span><span class="s1">] int c, [</span><span class="s3">out</span><span class="s1">] int *d);</span>
<span class="s1">};</span>

<span class="s1">[</span>
	<span class="s1">uuid(</span><span class="s4">5</span><span class="s1">a3e1d1d-947a-44ac-9b03-5c37d5f5fffc),</span>
	<span class="s1">version(</span><span class="s4">1.0</span><span class="s1">),</span>
	<span class="s1">helpstring(</span><span class="s2">&quot;TestComServer 1.0 Type library&quot;</span><span class="s1">)</span>
	<span class="s1">]</span>
<span class="s1">library TestComServerLib</span>
<span class="s1">{</span>
	<span class="s1">importlib(</span><span class="s2">&quot;stdole2.tlb&quot;</span><span class="s1">);</span>

	<span class="s3">typedef</span>
		<span class="s1">[</span>
			<span class="s1">uuid(</span><span class="s4">086</span><span class="s1">b7f11-aed0-4de0-b77a-f1998371da83)</span>
			<span class="s1">]</span>
		<span class="s3">struct </span><span class="s1">MYCOLOR {</span>
			<span class="s3">double </span><span class="s1">red;</span>
			<span class="s3">double </span><span class="s1">green;</span>
			<span class="s3">double </span><span class="s1">blue;</span>
		<span class="s1">} MYCOLOR;</span>

	<span class="s1">[</span>
		<span class="s1">uuid(</span><span class="s4">1f</span><span class="s1">ca61d1-a1a6-464c-b3a8-e9508b4ac8f7),</span>
		<span class="s1">helpstring(</span><span class="s2">&quot;TestComServer class object&quot;</span><span class="s1">)</span>
		<span class="s1">]</span>
		<span class="s1">coclass TestComServer {</span>
		<span class="s1">[</span><span class="s3">default</span><span class="s1">] </span><span class="s3">interface </span><span class="s1">ITestComServer;</span>
		<span class="s1">[</span><span class="s3">default</span><span class="s1">, source] </span><span class="s3">interface </span><span class="s1">ITestComServerEvents;</span>
	<span class="s1">};</span>
<span class="s1">};</span>
</pre>
</body>
</html>