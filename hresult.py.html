<html>
<head>
<title>hresult.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #808080;}
.s1 { color: #a9b7c6;}
.s2 { color: #6897bb;}
.s3 { color: #cc7832;}
</style>
</head>
<body bgcolor="#2b2b2b">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
hresult.py</font>
</center></td></tr></table>
<pre><span class="s0"># comtypes.hresult</span>
<span class="s0"># COM success and error codes</span>
<span class="s0">#</span>
<span class="s0"># Note that the codes should be written in decimal notation!</span>

<span class="s1">S_OK = </span><span class="s2">0</span>
<span class="s1">S_FALSE = </span><span class="s2">1</span>

<span class="s1">E_UNEXPECTED = -</span><span class="s2">2147418113 </span><span class="s0">#0x8000FFFFL</span>

<span class="s1">E_NOTIMPL = -</span><span class="s2">2147467263 </span><span class="s0">#0x80004001L</span>
<span class="s1">E_NOINTERFACE = -</span><span class="s2">2147467262 </span><span class="s0">#0x80004002L</span>
<span class="s1">E_POINTER = -</span><span class="s2">2147467261 </span><span class="s0">#0x80004003L</span>
<span class="s1">E_FAIL = -</span><span class="s2">2147467259 </span><span class="s0">#0x80004005L</span>
<span class="s1">E_INVALIDARG = -</span><span class="s2">2147024809 </span><span class="s0">#0x80070057L</span>
<span class="s1">E_OUTOFMEMORY = -</span><span class="s2">2147024882 </span><span class="s0"># 0x8007000EL</span>

<span class="s1">CLASS_E_NOAGGREGATION = -</span><span class="s2">2147221232 </span><span class="s0">#0x80040110L</span>
<span class="s1">CLASS_E_CLASSNOTAVAILABLE = -</span><span class="s2">2147221231 </span><span class="s0">#0x80040111L</span>

<span class="s1">CO_E_CLASSSTRING = -</span><span class="s2">2147221005 </span><span class="s0">#0x800401F3L</span>

<span class="s0"># connection point error codes</span>
<span class="s1">CONNECT_E_CANNOTCONNECT = -</span><span class="s2">2147220990</span>
<span class="s1">CONNECT_E_ADVISELIMIT = -</span><span class="s2">2147220991</span>
<span class="s1">CONNECT_E_NOCONNECTION = -</span><span class="s2">2147220992</span>

<span class="s1">TYPE_E_ELEMENTNOTFOUND = -</span><span class="s2">2147352077 </span><span class="s0">#0x8002802BL</span>

<span class="s1">TYPE_E_REGISTRYACCESS = -</span><span class="s2">2147319780 </span><span class="s0">#0x8002801CL</span>
<span class="s1">TYPE_E_CANTLOADLIBRARY = -</span><span class="s2">2147312566 </span><span class="s0">#0x80029C4AL</span>

<span class="s0"># all the DISP_E_ values from windows.h</span>
<span class="s1">DISP_E_BUFFERTOOSMALL = -</span><span class="s2">2147352557</span>
<span class="s1">DISP_E_DIVBYZERO = -</span><span class="s2">2147352558</span>
<span class="s1">DISP_E_NOTACOLLECTION = -</span><span class="s2">2147352559</span>
<span class="s1">DISP_E_BADCALLEE = -</span><span class="s2">2147352560</span>
<span class="s1">DISP_E_PARAMNOTOPTIONAL = -</span><span class="s2">2147352561 </span><span class="s0">#0x8002000F</span>
<span class="s1">DISP_E_BADPARAMCOUNT = -</span><span class="s2">2147352562 </span><span class="s0">#0x8002000E</span>
<span class="s1">DISP_E_ARRAYISLOCKED = -</span><span class="s2">2147352563 </span><span class="s0">#0x8002000D</span>
<span class="s1">DISP_E_UNKNOWNLCID = -</span><span class="s2">2147352564 </span><span class="s0">#0x8002000C</span>
<span class="s1">DISP_E_BADINDEX = -</span><span class="s2">2147352565 </span><span class="s0">#0x8002000B</span>
<span class="s1">DISP_E_OVERFLOW = -</span><span class="s2">2147352566 </span><span class="s0">#0x8002000A</span>
<span class="s1">DISP_E_EXCEPTION = -</span><span class="s2">2147352567 </span><span class="s0">#0x80020009</span>
<span class="s1">DISP_E_BADVARTYPE = -</span><span class="s2">2147352568 </span><span class="s0">#0x80020008</span>
<span class="s1">DISP_E_NONAMEDARGS = -</span><span class="s2">2147352569 </span><span class="s0">#0x80020007</span>
<span class="s1">DISP_E_UNKNOWNNAME = -</span><span class="s2">2147352570 </span><span class="s0">#0x80020006</span>
<span class="s1">DISP_E_TYPEMISMATCH = -</span><span class="s2">2147352571 </span><span class="s0">#0800020005</span>
<span class="s1">DISP_E_PARAMNOTFOUND = -</span><span class="s2">2147352572 </span><span class="s0">#0x80020004</span>
<span class="s1">DISP_E_MEMBERNOTFOUND = -</span><span class="s2">2147352573 </span><span class="s0">#0x80020003</span>
<span class="s1">DISP_E_UNKNOWNINTERFACE = -</span><span class="s2">2147352575 </span><span class="s0">#0x80020001</span>

<span class="s1">RPC_E_CHANGED_MODE = -</span><span class="s2">2147417850 </span><span class="s0"># 0x80010106</span>
<span class="s1">RPC_E_SERVERFAULT = -</span><span class="s2">2147417851 </span><span class="s0"># 0x80010105</span>

<span class="s0"># 'macros' and constants to create your own HRESULT values:</span>

<span class="s3">def </span><span class="s1">MAKE_HRESULT(sev</span><span class="s3">, </span><span class="s1">fac</span><span class="s3">, </span><span class="s1">code):</span>
    <span class="s0"># A hresult is SIGNED in comtypes</span>
    <span class="s3">from </span><span class="s1">ctypes </span><span class="s3">import </span><span class="s1">c_long</span>
    <span class="s3">return </span><span class="s1">c_long((sev &lt;&lt; </span><span class="s2">31 </span><span class="s1">| fac &lt;&lt; </span><span class="s2">16 </span><span class="s1">| code)).value</span>

<span class="s1">SEVERITY_ERROR = </span><span class="s2">1</span>
<span class="s1">SEVERITY_SUCCESS = </span><span class="s2">0</span>

<span class="s1">FACILITY_ITF = </span><span class="s2">4</span>
<span class="s1">FACILITY_WIN32 = </span><span class="s2">7</span>

<span class="s3">def </span><span class="s1">HRESULT_FROM_WIN32(x):</span>
    <span class="s0"># make signed</span>
    <span class="s3">from </span><span class="s1">ctypes </span><span class="s3">import </span><span class="s1">c_long</span>
    <span class="s1">x = c_long(x).value</span>
    <span class="s3">if </span><span class="s1">x &lt; </span><span class="s2">0</span><span class="s1">:</span>
        <span class="s3">return </span><span class="s1">x</span>
    <span class="s0"># 0x80000000 | FACILITY_WIN32 &lt;&lt; 16 | x &amp; 0xFFFF</span>
    <span class="s3">return </span><span class="s1">c_long(</span><span class="s2">0x80070000 </span><span class="s1">| (x &amp; </span><span class="s2">0xFFFF</span><span class="s1">)).value</span>
</pre>
</body>
</html>